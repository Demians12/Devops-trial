groups:
  - name: app.logs
    rules:
      - alert: LogsErrorBurst
        expr: |
          sum by (app, route, trace_id) (
            count_over_time(
              {namespace="apps"} 
              | json
              | status =~ "5.."
            [5m])
          ) > 5
        for: 2m
        labels:
          severity: ticket
          service: available-schedules
          team: platform
        annotations:
          summary: "LogsErrorBurst: explos√£o de respostas 5xx em 5m (Loki)"
          description: "Detecta burst de HTTP 5xx via access logs, agregado por app e rota."
          runbook_url: "runbooks/LogsErrorBurst.md"
